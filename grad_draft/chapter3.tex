%%%%
\chapter{関連研究}
本研究の関連研究の一つ目として、「大規模環境における故障検知についてのサーベイ」を挙げる。さらに、一つ目の関連研究で、大規模環境での有用な故障検知のソリューションとしてあげられたGossiip protocolに関して、応用した研究を紹介する。
\section{大規模環境における故障検知についてのサーベイ}
まず、故障検知の定義について言及する。故障検知とは故障しているノードについての情報を集めるプロセスのことであり、(故障が)疑わしきノードと、モニターしているノードのリストを管理している。リストは、スタティック、ダイナミックの二つがあり得る。ダイナミックなリストは、絶えず変化するノード群を管理していていることであり、これは、ネットワークの激しい変化に対しての対応能力を考慮すると、もっと現実的なモデルといえる。

さらに故障検知は、ハートビートとPingという二つのタイプのキープアライブメッセージを使って、故障しているノードを判断する。
\begin{itemize}
\item ハートビート\\
ハートビートは、モニターしているプロセスから故障検知を行うプロセスに定期的に送られてくるメッセージのことである。このメッセージで、対象ノードが故障していないことを知らせる。もし、ハートビートが制限時間内に届かなければ、故障検知を行うプロセスは、このノードは故障していると判断する。
\item Ping\\
Pingは、故障検知を行うプロセスからモニターしているノードに継続的に送られるメッセージのことである。故障検知を行うプロセスは、その応答として、Ackを受け取るを取ることを準備している。
もしキープアライブメッセージが届かなければ、精密な調査(タイムインターバルで区切られた一連のメッセージなど。)が行われ、実際にプロセスが故障しているかどうかが確かめられる。
\end{itemize}


実際のところメッセージ到達の遅れは予測できないので、非同期的な環境下で故障しているノードと健全なノードを見分けるのは困難である。よって、故障検知の問い合わせに対して返答がないプロセスは、「故障が疑わしき物」として扱われるのである。

次に論文では、大規模環境での故障検知を比較するための分類基準一式を提案している。
図は、その要約である。

\begin{itemize}
\item A.集中型 VS 分散型\\
集中型の故障検知は、単体で一枚岩的なモジュールで様々なプロセスをモニターすることが可能である。集中型の長所は管理コストが低いことで、欠点は単一故障点が存在すること、潜在的なボトルネックとなりやすいことである。一方、分散型の特徴は、これらの欠点がない。分散型は、一連の故障検知モジュール群とみなされていて、各モジュールにシステムの中で異なるプロセスが割り当てられている。リクエストが来るとすぐに、それぞれ各モジュールが故障が疑わしいノードのリストを提供する。
\item Pull型 VS Push型\\
キープアライブメッセージに関してPull型とPush型の二つの切り口がある。Push型アプローチは、ハートビートを用いており、制御フローと情報フローの方向は同じである。Pull型の故障検知は、そのフローは逆である。Pull型の故障検知においては、Pingメッセージが使われる。ハートビートは、Ping故障検知と比較して半分のメッセージのやりとりしか必要ないこと、タイムアウト遅延の見積もりが片道のメッセージで判断ができるので、アドバンテージがあると述べる著者を紹介している。
Ping故障検知の一つのアドバンテージは、時間の制御が故障検知をおこなうプロセスにおいてだけ実行されることである。
\item C.アクティブ VS パッシブ\\
アプリケーションを利用するかどうかで故障検知を分類している。アクティブプロトコルは、キープアライブメッセージを継続して送信、受信する。レイジーな、あるいはパッシブなプロトコルは、アプリケーションメッセージを利用して故障検知をおこなう。もしデータ通信が頻繁に発生するならば、故障検知は十分であると言える。一方でパッシブプロトコルが適切でない状況もあり、そうした状況ではアクティブプロトコルが必要になる。
\item D.ベースライン VS シェアリング\\
ノードの生存情報について共有するかどうかに関して、ベースラインとシェアリングの二つに分類することができる。シェアリングアプローチでは、故障検知するモジュールはモニターしているノードの生存情報について他のモジュールと共有する。ネットワークトポロージを考慮して、概して近隣ノード群が使われる。シェアリングアルゴリズムでは、交換される情報の種類、これらが維持するキープアライブ状態の分量において異なる。\\
土台アプローチでは、それぞれのモジュールは、独断で故障が疑われるノードについて判断を下す。
\item E.適応可能な値 VS 一定の値\\
キープアライブの頻度、タイムアウト、その他の時間は、適応可能(Adaptive)な値にするか、一定の値にするかで分類できる。一定の値を採用する利点は、例えば、ノードがシステムに参加したときなどにそれぞれのノードにおいて一回計算されるだけなので実装しやすい点である。欠点は、ネットワークの激しい変化状況では、効率性は制限されてしまうことである。\\
適応型の故障検知では例えば、送らせたタイムアウトを使うことで、新しいハートビートの到着時間を予想する。懸念は、こういった値やタイムアウトを計算することは、単純な仕事ではないことである、またいくつかのネットワーク情報を考慮しなければならない。
\item F.グローバル時刻 VS ローカル時刻\\
時間に関するその他の事柄は、個々でおこなうか、グローバルに行うかである。
単純なアプローチは、すべてのノードに対して、グローバルにキープアライブメッセージを出す頻度を利用することである。もしすべてのノードが同質で、同じセッションの存在時間を設けているならばこのアプローチは効果的である。一方、もしノードが同質でなかったら、個々のノードがそれぞれがローカル時刻を計算することになる。
\end{itemize}
他の基準を紹介する前に、我々は、大規模環境での故障検知のオペレーションのフレーズ「正常」、「伝搬」、「再設定」について説明する。
\begin{itemize}
\item 正常\\
「正常」フレーズにて、故障検知モジュールはキープアライブメッセージをモニターするノードに送信する。
\item 伝搬\\
故障が検知されたときに「伝搬」フレーズがスタートし、故障情報がその他のモジュールに伝えられる。
\item 再構成\\
「再構成」フレーズは「伝搬」フレーズが終了したときにスタートする。「再構成」フレーズは、ローカルの「再構成」とグローバルの「再構成」の二つフレーズから構成される。ローカルの「再構成」は、現存のモジュールがその故障を修理するときに行われる。例えば故障検知は、グループからノードを取り除くことができる。グローバルの「再構成」は、故障部位についての情報が他の故障検知モジュールに伝搬されるときに行われる。このオペレーションにより、他のノードはシステム情報の変化を反映させることができる。
\end{itemize}
大規模環境での故障検知では、二つのパフォーマス問題が存在する。モニタリングと、伝搬パターンである。迅速な伝搬は、システムの整合性(一貫性)を維持するのを補助し、効率的なモニターリングは検知時間を短縮する。
\begin{itemize}
\item G.モニターパターン\\
モニタリングのパターンは、「正常」フレーズにおける故障検知モジュールとモニターされているノードにおけるコミュニケーションに関連がある。モニタリングのパターンは、全対全型、ランダム型、近接ベース型の３つがある。
\begin{itemize}
\item 全対全型\\
全対全型の故障検知では、各モジュールがキープアライブメッセージをすべてのモニターしているプロセスに送信する。構成するグループのメンバーが少ない時、このアプローチは、効率的に機能する。一方で、スケーラビリティは制約される。プロセス数が膨れ上がった時には、大規模ネットワークトラフィックが発生するからである。
\item ランダム型\\
ランダム型の故障検知では、各メンバごとに故障検知に使用するためのアドレスと時間のリストを管理している。グループ内の各ノードは、ランダムに他のｋノードを選択して、キープアライブメッセージを送信する。\\
Gossiping protocolはハートビートをもとにランダムで故障検知を行うの故障検知の一つである。ゴシッピングはグループ数が少ないときはとても効率的であり、グループ数が多いときには複数のバリエーションがある。モニターしているノード同士でランダムであるいは定期的なコミュニケーションを通じて行われるランダム型の故障検知は、スケーラビリティを改善、検知時間の短縮ができる。故障検知時間は、ランダムに選択されることの確率に依存する。
\item 近接ベース型\\
各プロセスはキープアライブメッセージを近隣ノードに送る。コミュニケーションを制限し、ローカリティ性を考慮することで、パフォーマンスが改善される。近隣ノードは、故障を検知しない限り、時間がたっても静的に変化しない。故障を検知した場合は、故障したノードをのぞいたり新しい近隣ノードを選択するために「再構成」フェーズが必要になる。またネットワーク情報は考慮されなければならない。
\end{itemize}
\item H.故障の伝搬\\
あるノードが故障していると判断されたとき、この情報は他のモジュールに伝搬されなければならない。故障の伝搬は、大規模環境では非常に時間がかかるもので、伝搬にかかる時間を短縮するためにさまざまなアプローチが提案されている。全対全,ランダム,(リングあるいは)円形状の空間、階層構造がある。
\begin{itemize}
\item 全対全型の伝搬パターン\\
全対全型の伝搬パターンの場合、故障は瞬時にすべての故障検知モジュールに伝わる。もし故障、チャーンが頻繁に起こるならば、ネットワーク通信量が一気に跳ね上がってしまう。この場合、故障検知の実装は、パフォーマンスの理由からIPマルチキャストを利用するのがよいだろう。
\item ランダム型のな伝搬パターン\\
ランダム型のな伝搬パターンでは、モジュール、モジュール群が選択されて、現存する故障検知モジュールから故障についての情報を受け取る。利点は、コミュニケーションは全対全伝搬パターンにくらべて、少なくて十分なことである。一方欠点は、伝搬にかかる時間は、別のノードに選択される割合に依存していることである。
\item 円形状の空間の伝搬パターン\\
円形状の空間の故障検知では、仮想的なリングにノード群を配列する。コミュニケーションは、近接するノード群だけで行われる。欠点としては、新しいノードが追加されたり、リングからノードが離脱したときには、近接ノードは、再構成されなければならないことである。また、仮想的なネットワークトポロジに対して、仮想的なリングをマッピングしなければならないことでありこれは容易なことではない。また大きなリングにおいて、故障の伝搬に非常に時間がかかる。
\item 階層構造型の伝搬パターン\\
階層的な故障検知では、ノード群をマルチ階層に配列し、少ないグループのモニタリングに分断する。利点としては、ツリーにそって、故障が報告されるためにスケーラビリティが改善されることである。また、ネットワークインフラを考慮に入れることができるので効率的である。階層的な故障検知は、一般的に大規模分散システムにおいて用いられていおり、他の伝搬パターンで動作しているスモールグループ同士を連結している。
\end{itemize}


\end{itemize}

さらに論文では、故障検知のQoS指標について述べている。大規模環境における故障検知のQoSは、
一貫性、パフォーマンス、ダイナミックな環境に対する適応、スケーラビリティと関連している。

\begin{itemize}
\item 一貫性についての指標\\
(TODO:意味ブー)
故障検知は正確性と完全性という二つの主な分類可能な性質がある。正確性は、故障検知が犯すミスに言及していて、完全性は故障検知が最終的にノードが故障していると疑うことに言及している。故障検知のQos仕様のための主な指標と推論の正確性の指標を提案している。
完全性に関連している主な指標は、検知するまでの時間と故障検知にかかる時間である。
正解性と関連している二つの指標は、ミスの再発性、ミスが発生し続けている期間である。
推論される正解性の指標は、平均ミス率、クエリーの正確性の確率、よいレスポンスタイム、良い転送タイム？


\item パフォーマンスについての指標\\
 パフォーマンスの指標は、故障検知によって使われるリソース(ノード、ネットワークなど)と関連がある。主な指標は、CPUロード,メモリー消費、ネットワークバンド幅である。故障検知は、これらのリソースの消費を制限するかもしれないし、増加させるかもしれない。例えば、バンド幅の消費を減らすために、故障検知は、ネットワーク越しに送るメッセージ数を制限するかもしれない。
パフォーマンス指標は、故障検知が影響をあたえることができない(つまり、間接的に影響を与える)事柄もふくんでいる。これらの指標には、ノード故障率、ノード故障までの時間、平均復帰時間、平均故障間隔、平均ノード生存時間、また、遅延、メッセージロス、リンク故障率、リンク故障までの時間などのネットワークの振る舞いにも関連している。
\item ダイナミックな環境に対する適応についての指標\\
このカテゴリーは、故障検知がダイナミックなシステムの振る舞い(変化)に対応する能力に関連する指標を包含している。大規模環境の故障検知では、高いチャーン率、爆発的なメッセージ数の増加、メッセージロス、ヘテロな環境、柔軟性に適応できなければならない。適応性に関する指標は、ダイナミズム関連と、柔軟性に関連する指標の二つのグループに分類される。ネットワークダイナミズムに関連する指標は、故障検知が直接影響を及ぼせないようなパフォーマンス関連の指標に記述されている。フレキシビリティについての指標は、グローバルなあるいはローカルのkeep-aliveメッセージの割合、一定or変化するkeep-aliveメッセージの割合である。

\item スケーラビリティについての指標\\
スケーラビリティは、少なくとも以下に挙げる指標のうちの一つから定義される。
サイズスケーラビリティ、地理的なスケーラビリティ。スケーラビリティについての指標には、グループサイズや遅延が含まれている。
\end{itemize}

さらにこの指標と分類に基づいて、大規模分散環境のための主な故障検知ソリューションをいくつか挙げている。

\begin{itemize}
\item 生存情報を共有して、検知時間を改善する\\
故障検知時間は、近隣ノード間で生存情報を共有することで改善される。つまり、最初に故障を検知したノードが他のノードにアナウンスするのである。ある論文では、ネットワーク上の2000ノードで実験していみたところ、近隣のノードの数は増加するにもかかわらず、検知時間はほとんど変わらなかった。そこで、著者は、情報共有することで、高いチャーン率に適応するのを助けることができると主張する。
\item 適応性についてのソリューション\\
\item 
\item 
\item 
\item 
\end{itemize}









\section{関連研究２:Efficient Reconciliation and Flow Control for Anti-Entropy Protocols}
(TODO1:この論文、このアルゴリズムの立ち位置・位置づけを認識すること。)
(TODO: 具体的に、Cassandraとどう関わっているかを認識しろ。故障検知なのか？メンバーシップアルゴリズムなのか？その違いは？同時に？Cassandraの場合のgossipの動作は？)

