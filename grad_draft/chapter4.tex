%%%%
\chapter{Cassandraについて}
\section{Cassandraの概要}
 ・メンバーシップ周り？\\
 ・故障検知
 (もしかしたらリングの図とかはいるかもね。)
 ・seedの説明\\
 ・データ保管部分の解説\\
 ・ある特定のポートで通信を行なっている。\\
・cassandraは,IPアドレスのみでノードを判定している。\\
 
\section{Cassandraの軽量化}
(TODO1:具体的に数値を細かくだそうか。)
(TODO2:具体的に数値は環境依存だが、どう書く？)
実験を行うにあたって物理リソースの都合上、1台あたり複数の Cassandra ノー ドを起動する必要があった。デフォルトの設定では、１ノードのCassandra起動するためには、データを全く保持していない状態で、スレッド数が130、メモリー使用領域が、150M程度消費する。1台あたり多数のノードを立ち上げるために、データ保持部分のプログラムの改変と、設定ファイルのパラメータの調整を行った。
\subsection{プログラムの改変}
(TODO1:具体的に数値を細かく?)\\
Cassandraでは、何もデータを保持していない状態であっても,システム管理のためのテーブルを保持している。また、時間が経つと徐々にOnmemory上にmemtableとかが増えてしまことで、メモリー使用量域がかさむ。以下の点を踏まえて、メモリー使用領域を減らすために改変を加える。\\
私の実験では、実データがどのようなものかは関係がない。そこで、実際のデータを保存するのではなく、データサイズだけを保管するように変更した。その結果メモリー使用量域が減った。
また、時間が経過しても増加する量が抑えられた。

\subsection{設定ファイルのパラメータ調整}
(TODO2:現状は、非常に怪しい[column familyの定義を減らしたのが聞いてるだけってのもありうる。])\\
Cassandra１ノードで使用するスレッドは非常に多い。できるだけスレッド数を減らすために設定ファイルを変更した。具体的には、Cassandraが起動時に呼び込むstorage.confというファイルである。変更したパラメータは、\\
\begin{itemize}
\item $concurrent_reads$ : いくつまで同時読み込みを許すしきい値
\item $concurrent_writes$: いくつまで同時書き込みを許すしきい値
\end{itemize}
このパラメータは,Cassandra(の？)で使用するスレッド数に直結するので、この数を32 - > 2 ,132 - > 2と減らすことで、全体のスレッド数をを130 ->  100に落とした。


